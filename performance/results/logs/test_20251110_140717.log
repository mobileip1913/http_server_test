2025-11-10 14:07:17 | INFO     | 正在生成测试音频帧...
2025-11-10 14:07:17 | INFO     | Using pre-generated audio file: D:\code\vb_eye_st7789\performance\audio\test_audio.opus
2025-11-10 14:07:17 | INFO     | Detected Ogg Opus container, converting with ffmpeg...
2025-11-10 14:07:17 | INFO     | Converting Ogg Opus to PCM and re-encoding to raw Opus packets...
2025-11-10 14:07:17 | INFO     | Processed remaining 564 bytes PCM data with 1356 bytes padding (total 92724 bytes)
2025-11-10 14:07:17 | INFO     | Generated 49 raw Opus packets from PCM data (total 9081 bytes, processed 92724 bytes PCM, coverage: 98.6%)
2025-11-10 14:07:17 | INFO     | Detected 49 raw Opus packets from Ogg container. These MUST be sent individually (one per WebSocket message), ignoring SPLIT_OPUS_PACKETS=False
2025-11-10 14:07:17 | INFO     | Detected 49 raw Opus packets from Ogg container. These MUST be sent individually, ignoring SPLIT_OPUS_PACKETS=False
2025-11-10 14:07:17 | INFO     | 已生成 49 个 Opus 帧，总计 9081 字节
2025-11-10 14:07:17 | INFO     | ============================================================
2025-11-10 14:07:17 | INFO     | 开始 WebSocket 性能测试 - 测试模式
2025-11-10 14:07:17 | INFO     | ============================================================
2025-11-10 14:07:17 | INFO     | 并发连接数: 1
2025-11-10 14:07:17 | INFO     | ⚡ 极限性能模式: 已启用（根据并发数动态调整等待时间）
2025-11-10 14:07:17 | INFO     |    - Auth等待: 0.5秒
2025-11-10 14:07:17 | INFO     |    - 响应等待: 15.2秒（动态计算：基础15.0秒 + 每个连接0.15秒 × 1连接）
2025-11-10 14:07:17 | INFO     |    - 最后等待: 0.1秒
2025-11-10 14:07:17 | INFO     | 测试消息: 你好啊，我想去故宫
2025-11-10 14:07:17 | INFO     | 服务器地址: ws://toyaiws.spacechaintech.com:8081/?sn=FC012C2EA0A0&sign=c61505cccb8dc83d8e67450cbd4f32c4&platform=hw&bid=TKAI_BOARD_03_4G_VB6824_EYE_ST7789&fv=0.0.1&fvc=20250908001&strategy_id=0&uid=0&board_type=wifi&recover=0&enableP3=2&tool=idf&screen=1
2025-11-10 14:07:17 | INFO     | 设备SN: FC012C2EA0A0 (已注册)
2025-11-10 14:07:17 | INFO     | 板卡类型: wifi
2025-11-10 14:07:17 | INFO     | 发送音频数据: True
2025-11-10 14:07:17 | INFO     | ============================================================
2025-11-10 14:07:17 | INFO     | 测试开始
2025-11-10 14:07:17 | INFO     | 等待 1 个连接完成...
2025-11-10 14:07:17 | INFO     | 连接 #1: 开始... (USE_IOT_SIMULATOR=True)
2025-11-10 14:07:18 | INFO     | [CONNECTION] Connection #1 | Status: success | Duration: 1126.86ms
2025-11-10 14:07:22 | INFO     | Connection #1: STT response received in 3350.43ms | Recognized text: 我想买一瓶红酒，你有推荐吗？
2025-11-10 14:07:22 | INFO     | Connection #1: TTS start | State: start
2025-11-10 14:07:23 | INFO     | Connection #1: Received emoji message | Emotion: happy
2025-11-10 14:07:25 | INFO     | Connection #1: TTS sentence_start | Text: 。SOOLE赤霞珠干红葡萄酒-绚丽。：果香醇
。SOOLE赤霞珠干红葡萄酒-荣耀。：风味佳
。红酒/葡萄酒单只礼盒。：很实惠 

这些都是不错的红酒哦。
2025-11-10 14:07:38 | INFO     | 测试结束
2025-11-10 14:07:38 | INFO     | 导出测试结果...
2025-11-10 14:07:38 | INFO     | CSV 已导出到: results\csv\test_results_20251110_140717.csv
2025-11-10 14:07:38 | WARNING  | ⚠️ 没有complete=True的消息！成功连接数: 1, 示例数据: [{'id': 1, 'complete': False, 'send_time': 835.1767578125, 'stt_time': 3350.432861328125, 'llm_time': None, 'tts_start_time': None, 'tts_duration': None, 'total_response_time': 3350.432861328125, 'received_messages': 237}]
2025-11-10 14:07:38 | INFO     | JSON 已导出到: results\json\test_results_20251110_140717.json
2025-11-10 14:07:38 | WARNING  | ⚠️ 没有complete=True的消息！成功连接数: 1, 示例数据: [{'id': 1, 'complete': False, 'send_time': 835.1767578125, 'stt_time': 3350.432861328125, 'llm_time': None, 'tts_start_time': None, 'tts_duration': None, 'total_response_time': 3350.432861328125, 'received_messages': 237}]
2025-11-10 14:07:38 | INFO     | ============================================================
2025-11-10 14:07:38 | INFO     | 性能测试摘要
2025-11-10 14:07:38 | INFO     | ============================================================
2025-11-10 14:07:38 | INFO     | 测试总时长: 21.71秒
2025-11-10 14:07:38 | INFO     | 
2025-11-10 14:07:38 | INFO     | 连接指标:
2025-11-10 14:07:38 | INFO     |   总连接数: 1
2025-11-10 14:07:38 | INFO     |   成功连接数: 1
2025-11-10 14:07:38 | INFO     |   失败连接数: 0
2025-11-10 14:07:38 | INFO     |   连接成功率: 100.00%
2025-11-10 14:07:38 | INFO     |   平均连接时间: 1.127秒
2025-11-10 14:07:38 | INFO     | 
2025-11-10 14:07:38 | INFO     | 消息指标:
2025-11-10 14:07:38 | INFO     |   总消息数: 1
2025-11-10 14:07:38 | INFO     |   成功消息数: 0
2025-11-10 14:07:38 | INFO     |   失败消息数: 1
2025-11-10 14:07:38 | INFO     |   消息成功率: 0.00%
2025-11-10 14:07:38 | INFO     | 
2025-11-10 14:07:38 | INFO     | 响应时间指标:
2025-11-10 14:07:38 | INFO     |   平均总响应时间: 0.000秒
2025-11-10 14:07:38 | INFO     |   平均STT识别时间: 0.000秒
2025-11-10 14:07:38 | INFO     |   平均LLM响应时间: 0.000秒
2025-11-10 14:07:38 | INFO     |   平均TTS合成时长: 0.000秒
2025-11-10 14:07:38 | INFO     |   P95响应时间: 0.000秒
2025-11-10 14:07:38 | INFO     |   P99响应时间: 0.000秒
2025-11-10 14:07:38 | INFO     |   最小响应时间: 0.000秒
2025-11-10 14:07:38 | INFO     |   最大响应时间: 0.000秒
2025-11-10 14:07:38 | INFO     | 
2025-11-10 14:07:38 | INFO     | 吞吐量指标:
2025-11-10 14:07:38 | INFO     |   QPS (每秒查询数): 0.05
2025-11-10 14:07:38 | INFO     | ============================================================
2025-11-10 14:07:38 | INFO     | [STATISTICS] Total Connections: 1 | Active: 1 | Success: 1 | Failed: 0 | QPS: 0.05 | Avg Response: 0.00ms | P95: 0.00ms | P99: 0.00ms
2025-11-10 14:07:38 | INFO     | 测试完成。结果已保存到:
2025-11-10 14:07:38 | INFO     |   CSV: results\csv\test_results_20251110_140717.csv
2025-11-10 14:07:38 | INFO     |   JSON: results\json\test_results_20251110_140717.json
